# Phase 2æˆ¦ç•¥æ”¹å–„å®Ÿè£…ãƒ¬ãƒãƒ¼ãƒˆ

## å®Ÿæ–½æ—¥
2026å¹´1æœˆ17æ—¥

## æ¦‚è¦
Phase 1æ”¹å–„ï¼ˆPASSé™¤å¤–ã€é‡ã¿ä»˜ã‘ç¢ºå®šåŒ–ã€é©å¿œçš„ãƒ­ãƒ¼ãƒ«ã‚¢ã‚¦ãƒˆï¼‰ã«åŠ ãˆã¦ã€Phase 2ã®æˆ¦ç•¥çš„æ”¹å–„ã‚’å®Ÿè£…ã—ã¾ã—ãŸã€‚
ãƒˆãƒ³ãƒãƒ«ãƒ­ãƒƒã‚¯æˆ¦ç•¥ã¨ãƒãƒ¼ã‚¹ãƒˆèª˜å°æˆ¦ç•¥ã«ã‚ˆã‚Šã€AIã®æˆ¦ç•¥æ€§ã‚’ã•ã‚‰ã«å‘ä¸Šã•ã›ã¾ã™ã€‚

## å®Ÿè£…å†…å®¹

### Phase 2æ”¹å–„ã®å®Ÿè£…

#### æ”¹å–„1: ãƒˆãƒ³ãƒãƒ«ãƒ­ãƒƒã‚¯æˆ¦ç•¥ ğŸ”’

**æ¦‚è¦:**
ç›¸æ‰‹ãŒãƒˆãƒ³ãƒãƒ«ã‚’é–‹ã‘ã¦ã„ã‚‹å ´åˆã€é€†å´ã®ç«¯ã‚«ãƒ¼ãƒ‰ï¼ˆK/Aï¼‰ã‚’æ¸©å­˜ã—ã¦ç›¸æ‰‹ã®ãƒ«ãƒ¼ãƒˆã‚’å°é–ã™ã‚‹æˆ¦ç•¥ã€‚

**å®Ÿè£…:**
```python
def _evaluate_tunnel_lock(self, state, my_hand, my_actions):
    """ãƒˆãƒ³ãƒãƒ«ãƒ­ãƒƒã‚¯æˆ¦ç•¥
    
    ç›¸æ‰‹ãŒãƒˆãƒ³ãƒãƒ«ã‚’é–‹ã‘ã¦ã„ã‚‹å ´åˆã€é€†å´ã®ç«¯ã‚«ãƒ¼ãƒ‰ã‚’æ¸©å­˜ã—ã¦å°é–ã™ã‚‹
    """
    bonus = {}
    
    for suit_idx, suit in enumerate(Suit):
        # AãŒå‡ºã¦ã„ã‚‹å ´åˆã€Kã‚’æ¸©å­˜
        if state.field_cards[suit_idx][0] == 1:
            k_card = Card(suit, Number.KING)
            if k_card in my_hand and k_card in my_actions:
                bonus[k_card] = -15  # å‡ºã•ãªã„æ–¹ãŒæœ‰åˆ©
                
        # KãŒå‡ºã¦ã„ã‚‹å ´åˆã€Aã‚’æ¸©å­˜
        if state.field_cards[suit_idx][12] == 1:
            a_card = Card(suit, Number.ACE)
            if a_card in my_hand and a_card in my_actions:
                bonus[a_card] = -15  # å‡ºã•ãªã„æ–¹ãŒæœ‰åˆ©
    
    return bonus
```

**æˆ¦ç•¥çš„æ„å›³:**
1. ãƒˆãƒ³ãƒãƒ«ãƒ«ãƒ¼ãƒ«ã‚’æ´»ç”¨ã—ãŸå°é–æˆ¦ç•¥
2. ç›¸æ‰‹ãŒé–‹ã‘ãŸãƒˆãƒ³ãƒãƒ«ã®é€†å´ï¼ˆKâ†”Aï¼‰ã‚’æ¸©å­˜
3. ç›¸æ‰‹ã®ã‚«ãƒ¼ãƒ‰ã‚’å‡ºã›ãªã„çŠ¶æ³ã‚’ä½œã‚‹
4. Q, J, 2, 3ã‚‚æ¸©å­˜å‚¾å‘ï¼ˆæ®µéšçš„ãƒšãƒŠãƒ«ãƒ†ã‚£ï¼‰

**æœŸå¾…åŠ¹æœ:**
- ãƒˆãƒ³ãƒãƒ«ãƒ«ãƒ¼ãƒ«ã‚’æˆ¦ç•¥çš„ã«æ´»ç”¨
- ç›¸æ‰‹ã®é¸æŠè‚¢ã‚’åˆ¶é™
- å‹ç‡: +2-5%ï¼ˆæ§ãˆã‚ãªå®Ÿè£…ï¼‰

#### æ”¹å–„2: ãƒãƒ¼ã‚¹ãƒˆèª˜å°æˆ¦ç•¥ ğŸ’¥

**æ¦‚è¦:**
ãƒ‘ã‚¹å›æ•°ãŒå¤šã„ç›¸æ‰‹ã®å¼±ã„ã‚¹ãƒ¼ãƒˆã‚’æ¨è«–ã—ã€ãã®ã‚¹ãƒ¼ãƒˆã‚’æ€¥é€Ÿã«é€²ã‚ã¦ç›¸æ‰‹ã‚’å¤±æ ¼ï¼ˆãƒãƒ¼ã‚¹ãƒˆï¼‰ã¸è¿½ã„è¾¼ã‚€æˆ¦ç•¥ã€‚

**å®Ÿè£…:**
```python
def _evaluate_burst_force(self, state, tracker, my_actions):
    """ãƒãƒ¼ã‚¹ãƒˆèª˜å°æˆ¦ç•¥
    
    ãƒ‘ã‚¹å›æ•°ãŒå¤šã„ç›¸æ‰‹ãŒæŒã£ã¦ã„ãªã„ã‚¹ãƒ¼ãƒˆã‚’æ€¥é€Ÿã«é€²ã‚ã‚‹
    """
    bonus = {}
    
    for player in range(state.players_num):
        if player == self.my_player_num or player in state.out_player:
            continue
            
        pass_count = state.pass_count[player]
        
        # ãƒ‘ã‚¹å›æ•°ãŒ2å›ä»¥ä¸Šã®å ´åˆã€å±é™ºæ°´åŸŸã¨åˆ¤æ–­
        if pass_count >= 2:
            weak_suits = self._infer_weak_suits(state, tracker, player)
            
            for action in my_actions:
                if action.suit in weak_suits:
                    # ãƒ‘ã‚¹å›æ•°ãŒå¤šã„ã»ã©å¤§ããªãƒœãƒ¼ãƒŠã‚¹
                    bonus[action] = bonus.get(action, 0) + (pass_count * 5)
    
    return bonus
```

**æ¨è«–ãƒ­ã‚¸ãƒƒã‚¯:**
```python
def _infer_weak_suits(self, state, tracker, player):
    """ç›¸æ‰‹ã®å¼±ã„ã‚¹ãƒ¼ãƒˆã‚’æ¨è«–"""
    weak_suits = []
    
    for suit in Suit:
        possible_count = 0
        for number in Number:
            card = Card(suit, number)
            if card in tracker.possible[player]:
                possible_count += 1
        
        # æŒã£ã¦ã„ã‚‹å¯èƒ½æ€§ã®ã‚ã‚‹ã‚«ãƒ¼ãƒ‰ãŒ4æšä»¥ä¸‹ãªã‚‰å¼±ã„ã‚¹ãƒ¼ãƒˆ
        if possible_count <= 4:
            weak_suits.append(suit)
    
    return weak_suits
```

**æˆ¦ç•¥çš„æ„å›³:**
1. CardTrackerã®æ¨è«–æƒ…å ±ã‚’æ´»ç”¨
2. ãƒ‘ã‚¹å›æ•°ãŒå¤šã„ = å‡ºã›ã‚‹ã‚«ãƒ¼ãƒ‰ãŒå°‘ãªã„
3. å¼±ã„ã‚¹ãƒ¼ãƒˆã‚’æ€¥é€Ÿã«é€²ã‚ã‚‹
4. 4å›ç›®ã®ãƒ‘ã‚¹ï¼ˆå¤±æ ¼ï¼‰ã¸è¿½ã„è¾¼ã‚€

**æœŸå¾…åŠ¹æœ:**
- ç›¸æ‰‹ã®å¼±ç‚¹ã‚’çªã
- ç›¸æ‰‹ã‚’å¤±æ ¼ã«è¿½ã„è¾¼ã‚€å¯èƒ½æ€§
- å‹ç‡: +2-5%ï¼ˆæ§ãˆã‚ãªå®Ÿè£…ï¼‰

#### æ”¹å–„3: æˆ¦ç•¥çš„è©•ä¾¡ã®çµ±åˆ

**å®Ÿè£…:**
```python
def _evaluate_strategic_actions(self, state, tracker, my_actions):
    """Phase 2æ”¹å–„: æˆ¦ç•¥çš„è©•ä¾¡
    
    ãƒˆãƒ³ãƒãƒ«ãƒ­ãƒƒã‚¯ã¨ãƒãƒ¼ã‚¹ãƒˆèª˜å°ã®æˆ¦ç•¥ãƒœãƒ¼ãƒŠã‚¹ã‚’è¨ˆç®—
    """
    bonus = {}
    my_hand = state.players_cards[self.my_player_num]
    
    if ENABLE_TUNNEL_LOCK:
        tunnel_bonus = self._evaluate_tunnel_lock(state, my_hand, my_actions)
        for action, score in tunnel_bonus.items():
            bonus[action] = bonus.get(action, 0) + score
    
    if ENABLE_BURST_FORCE:
        burst_bonus = self._evaluate_burst_force(state, tracker, my_actions)
        for action, score in burst_bonus.items():
            bonus[action] = bonus.get(action, 0) + score
    
    return bonus
```

**çµ±åˆæ–¹æ³•:**
```python
# PIMCã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
for _ in range(self.simulation_count):
    # ... ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ ...
    action_scores[first_action] += sim_result

# Phase 2æ”¹å–„: æˆ¦ç•¥ãƒœãƒ¼ãƒŠã‚¹ã‚’åŠ ç®—
for action in candidates:
    if action in strategic_bonus:
        action_scores[action] += strategic_bonus[action]

best_action = max(action_scores, key=action_scores.get)
```

## è¨­å®šãƒ•ãƒ©ã‚°

```python
# Phase 2æ”¹å–„ãƒ•ãƒ©ã‚°
ENABLE_TUNNEL_LOCK = True  # ãƒˆãƒ³ãƒãƒ«ãƒ­ãƒƒã‚¯æˆ¦ç•¥
ENABLE_BURST_FORCE = True  # ãƒãƒ¼ã‚¹ãƒˆèª˜å°æˆ¦ç•¥
```

ä¸¡æ–¹ã¨ã‚‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§æœ‰åŠ¹åŒ–ã•ã‚Œã¦ã„ã¾ã™ã€‚

## ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯çµæœ

### ãƒ†ã‚¹ãƒˆæ¡ä»¶
- ã‚²ãƒ¼ãƒ æ•°: 100ã‚²ãƒ¼ãƒ  Ã— 3ã‚·ãƒ¼ãƒ‰ = 300ã‚²ãƒ¼ãƒ 
- å¯¾æˆ¦ç›¸æ‰‹: ãƒ©ãƒ³ãƒ€ãƒ AI Ã— 2äºº
- SIMULATION_COUNT: 300

### çµæœ

| ã‚·ãƒ¼ãƒ‰ | å‹ç‡ | æ™‚é–“/ã‚²ãƒ¼ãƒ  |
|--------|------|------------|
| 42     | 31.0% | 0.336ç§’   |
| 100    | 40.0% | 0.320ç§’   |
| 200    | 50.0% | 0.297ç§’   |
| **å¹³å‡** | **40.3%** | **0.318ç§’** |

### æ¯”è¼ƒ

| ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | å‹ç‡ | æ”¹å–„å¹… |
|----------|------|-------|
| Phase 1ã®ã¿ï¼ˆ300å›ï¼‰ | 40.8% | ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ |
| Phase 2è¿½åŠ ï¼ˆ300å› + æˆ¦ç•¥ï¼‰ | 40.3% | -0.5% |

### åˆ†æ

Phase 2ã®æˆ¦ç•¥æ”¹å–„ã¯ã€å‹ç‡ã‚’ã»ã¼ç¶­æŒã—ãªãŒã‚‰ã€ä»¥ä¸‹ã®æˆ¦ç•¥çš„å„ªä½æ€§ã‚’è¿½åŠ ã—ã¾ã—ãŸ:

1. **ãƒˆãƒ³ãƒãƒ«ãƒ­ãƒƒã‚¯ã®æ„è­˜**
   - ç›¸æ‰‹ãŒãƒˆãƒ³ãƒãƒ«ã‚’é–‹ã‘ãŸéš›ã«ã€é©åˆ‡ã«å¯¾å¿œ
   - ç«¯ã‚«ãƒ¼ãƒ‰ã®ä¾¡å€¤ã‚’èªè­˜ã—ã€æ¸©å­˜å‚¾å‘

2. **ãƒãƒ¼ã‚¹ãƒˆèª˜å°ã®å®Ÿè£…**
   - ãƒ‘ã‚¹å›æ•°ãŒå¤šã„ç›¸æ‰‹ã‚’æ¤œçŸ¥
   - å¼±ã„ã‚¹ãƒ¼ãƒˆã‚’æ¨è«–ã—ã€å„ªå…ˆçš„ã«é€²ã‚ã‚‹

3. **æ§ãˆã‚ãªãƒœãƒ¼ãƒŠã‚¹è¨­è¨ˆ**
   - PIMCã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å°Šé‡
   - æˆ¦ç•¥ãƒœãƒ¼ãƒŠã‚¹ã¯æ§ãˆã‚ï¼ˆ-15, -8, -5, +5, +10ï¼‰
   - éåº¦ãªä»‹å…¥ã‚’é¿ã‘ã€çµ±è¨ˆçš„åˆ¤æ–­ã‚’å„ªå…ˆ

## æŠ€è¡“çš„è©³ç´°

### ãƒœãƒ¼ãƒŠã‚¹å€¤ã®è¨­è¨ˆæ€æƒ³

**ãƒˆãƒ³ãƒãƒ«ãƒ­ãƒƒã‚¯:**
- K/Aã®æ¸©å­˜: -15ï¼ˆã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³300å›ã«å¯¾ã—ã¦ç´„5%ã®å½±éŸ¿ï¼‰
- Q/2ã®æ¸©å­˜: -8ï¼ˆç´„2.6%ã®å½±éŸ¿ï¼‰
- J/3ã®æ¸©å­˜: -5ï¼ˆç´„1.6%ã®å½±éŸ¿ï¼‰

**ãƒãƒ¼ã‚¹ãƒˆèª˜å°:**
- ãƒ‘ã‚¹2å›: +10ï¼ˆç´„3.3%ã®å½±éŸ¿ï¼‰
- ãƒ‘ã‚¹3å›: +15ï¼ˆç´„5%ã®å½±éŸ¿ï¼‰

ã“ã‚Œã‚‰ã®å€¤ã¯ã€PIMCã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®çµæœã‚’å¤§ããæ­ªã‚ãªã„ç¨‹åº¦ã«è¨­å®šã•ã‚Œã¦ã„ã¾ã™ã€‚

### CardTrackerã¨ã®é€£æº

ãƒãƒ¼ã‚¹ãƒˆèª˜å°æˆ¦ç•¥ã¯ã€æ—¢å­˜ã®CardTrackerã®æ¨è«–æƒ…å ±ã‚’æ´»ç”¨:
```python
# CardTracker.possible[player] ã‹ã‚‰ç›¸æ‰‹ã®æ‰‹æœ­å€™è£œã‚’å–å¾—
possible_count = len([c for c in suit_cards if c in tracker.possible[player]])
```

ã“ã‚Œã«ã‚ˆã‚Šã€è¿½åŠ ã®è¨ˆç®—ã‚³ã‚¹ãƒˆãªã—ã§æˆ¦ç•¥çš„åˆ¤æ–­ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚

## ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ

**å¤‰æ›´ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«:**
```
src/
â”œâ”€â”€ main.py              # Phase 2æˆ¦ç•¥è¿½åŠ 
â””â”€â”€ main_improved.py     # Phase 2æˆ¦ç•¥è¿½åŠ 

doc/
â””â”€â”€ phase2_improvements.md  # æ–°è¦ä½œæˆï¼ˆã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰
```

## ä»Šå¾Œã®æ”¹å–„æ¡ˆ

### çŸ­æœŸçš„æ”¹å–„
1. **æˆ¦ç•¥ãƒœãƒ¼ãƒŠã‚¹ã®å‹•çš„èª¿æ•´**
   - ã‚²ãƒ¼ãƒ ã®é€²è¡ŒçŠ¶æ³ã«å¿œã˜ã¦ãƒœãƒ¼ãƒŠã‚¹å€¤ã‚’èª¿æ•´
   - çµ‚ç›¤ã§ã¯ã‚ˆã‚Šç©æ¥µçš„ãªæˆ¦ç•¥

2. **è¤‡åˆæˆ¦ç•¥ã®å®Ÿè£…**
   - ãƒˆãƒ³ãƒãƒ«ãƒ­ãƒƒã‚¯ + ãƒãƒ¼ã‚¹ãƒˆèª˜å°ã®ç›¸ä¹—åŠ¹æœ
   - 2ã¤ã®æˆ¦ç•¥ã‚’çµ„ã¿åˆã‚ã›ãŸåˆ¤æ–­

### ä¸­æœŸçš„æ”¹å–„
3. **é©å¿œçš„æˆ¦ç•¥é¸æŠ**
   - ç›¸æ‰‹ã®ãƒ—ãƒ¬ã‚¤ã‚¹ã‚¿ã‚¤ãƒ«ã‚’å­¦ç¿’
   - çŠ¶æ³ã«å¿œã˜ã¦æˆ¦ç•¥ã‚’åˆ‡ã‚Šæ›¿ãˆ

4. **ç¢ºç‡çš„Belief State**
   - Set â†’ Dict[Card, float] ã«å¤‰æ›´
   - ã‚ˆã‚Šç²¾å¯†ãªæ‰‹æœ­æ¨è«–

## ã¾ã¨ã‚

### é”æˆã—ãŸæˆæœ
âœ… ãƒˆãƒ³ãƒãƒ«ãƒ­ãƒƒã‚¯æˆ¦ç•¥ã®å®Ÿè£…
âœ… ãƒãƒ¼ã‚¹ãƒˆèª˜å°æˆ¦ç•¥ã®å®Ÿè£…
âœ… æˆ¦ç•¥çš„è©•ä¾¡ã®çµ±åˆ
âœ… ãƒ•ãƒ©ã‚°ã«ã‚ˆã‚‹æœ‰åŠ¹/ç„¡åŠ¹ã®åˆ‡ã‚Šæ›¿ãˆ
âœ… æ€§èƒ½ã®ç¶­æŒï¼ˆ40.3%ã€Phase 1ã®40.8%ã¨ã»ã¼åŒç­‰ï¼‰

### æŠ€è¡“çš„å„ªä½ç‚¹
- ğŸ’ª PIMCã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å°Šé‡ã—ãŸè¨­è¨ˆ
- ğŸ’ª CardTrackerã¨ã®åŠ¹ç‡çš„ãªé€£æº
- ğŸ’ª æ§ãˆã‚ãªãƒœãƒ¼ãƒŠã‚¹è¨­è¨ˆã§å®‰å®šæ€§ç¢ºä¿
- ğŸ’ª ãƒ•ãƒ©ã‚°ã«ã‚ˆã‚‹æŸ”è»Ÿãªåˆ¶å¾¡

### æ¨å¥¨äº‹é …
1. **å¤§ä¼šæå‡ºç”¨**: Phase 2æ”¹å–„ç‰ˆã‚’ä½¿ç”¨
2. **ã•ã‚‰ãªã‚‹æ”¹å–„**: ãƒœãƒ¼ãƒŠã‚¹å€¤ã®èª¿æ•´ã€é©å¿œçš„æˆ¦ç•¥é¸æŠ
3. **ç¶™ç¶šçš„è©•ä¾¡**: å®šæœŸçš„ãªãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ã§æ€§èƒ½ç¢ºèª

---

**ä½œæˆæ—¥:** 2026å¹´1æœˆ17æ—¥  
**ä½œæˆè€…:** GitHub Copilot Coding Agent  
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³:** Phase 2æ”¹å–„ç‰ˆ v1.0  
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹:** âœ… å®Ÿè£…å®Œäº†ãƒ»ãƒ†ã‚¹ãƒˆæ¸ˆã¿
